%h1 記事一覧

%p 記事とは、読者に有用な情報を届けるための文章です。markdown記法を使用することができます。

%p
  = bootstrap_form_tag url: editor_posts_path, method: :get, layout: :inline do |f|
    = f.search_field 'query[public_id]', value: @search_query_params[:public_id], placeholder: 'Public ID', skip_label: true
    = f.search_field 'query[title]', value: @search_query_params[:title], placeholder: 'Title', skip_label: true
    = f.collection_select 'query[category_id]', current_site.categories.leaves, :id, :full_name, {selected: @search_query_params[:category_id], prompt: 'Category', skip_label: true}, {class: "form-control select2", "data-select2-allow-clear": true}
    = f.submit 'Search'

= link_to 'New Post', new_editor_post_url, class: 'btn btn-default'

%table.table.post
  %thead
    %tr
      %th Public ID
      %th Title
      %th Categories
      %th Published at
      %th Thumbnail
      %th Published
      %th
      %th
      %th

  %tbody
    - @posts.each do |post|
      %tr{ class: post.published? ? nil : 'post--unpublished' }
        %td= post.public_id
        %td= post.title
        %td
          %ul
            - post.categories.each do |category|
              %li= category.name
        %td= l post.published_at if post.published_at
        %td= image_tag post.thumbnail_url, height: 80 if post.thumbnail.present?
        %td= post.published? ? icon('check-square-o') : icon('square-o')
        %td= link_to 'Show', editor_post_url(public_id: post.public_id)
        %td= link_to 'Preview', preview_editor_post_url(public_id: post.public_id), target: '_blank'
        %td= link_to 'Edit', edit_editor_post_url(public_id: post.public_id)
        %td= link_to 'Destroy', editor_post_url(public_id: post.public_id), method: :delete, data: { confirm: 'Are you sure?' }

- if @posts.total_pages > 1
  .text-center
    %nav.pagination
      = paginate @posts, views_prefix: 'editor'
      %p.pagination__entries= page_entries_info @posts
